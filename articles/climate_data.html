<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ColOpenData">
<title>How to download climate data using ColOpenData • ColOpenData</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to download climate data using ColOpenData">
<meta property="og:description" content="ColOpenData">
<meta property="og:image" content="https://epiverse-trace.github.io/ColOpenData/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark" data-bs-theme="dark"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">ColOpenData</a>
    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Documentation and Dictionaries</h6></li>
    <li><a class="dropdown-item" href="../articles/documentation_and_dictionaries.html">Documentation and Dictionaries</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Download data</h6></li>
    <li><a class="dropdown-item" href="../articles/demographic_data.html">A Deep Dive into Colombian Demographics Using ColOpenData</a></li>
    <li><a class="dropdown-item" href="../articles/geospatial_data.html">Maps and plots with ColOpenData</a></li>
    <li><a class="dropdown-item" href="../articles/climate_data.html">How to download climate data using ColOpenData</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/ColOpenData/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>
  </div>
</nav><div class="container template-article">



<link href="climate_data_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="climate_data_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="climate_data_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="climate_data_files/leaflet-1.3.1/leaflet.js"></script><link href="climate_data_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="climate_data_files/proj4-2.6.2/proj4.min.js"></script><script src="climate_data_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="climate_data_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="climate_data_files/leaflet-binding-2.2.2/leaflet.js"></script><script src="climate_data_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="climate_data_files/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>How to download climate data using ColOpenData</h1>
                        <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/ColOpenData/blob/HEAD/vignettes/climate_data.Rmd" class="external-link"><code>vignettes/climate_data.Rmd</code></a></small>
      <div class="d-none name"><code>climate_data.Rmd</code></div>
    </div>
        <div style="text-align: justify;">
<p><strong>ColOpenData</strong> can be used to access open climate data
from Colombia. This climate data is retrieved from the Institute of
Hydrology, Meteorology and Environmental Studies <a href="http://www.ideam.gov.co/" class="external-link">(IDEAM)</a>. The climate module allows
the user to consult climate data for any Region of Interest (ROI) inside
the country and retrieve the information for each station contained
inside.</p>
<p>The available information from IDEAM can be accessed using specific
internal tags as follows:</p>
</div>
<table class="table">
<thead><tr class="header">
<th align="left">Tags</th>
<th align="left">Variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TSSM_CON</td>
<td align="left">Dry-bulb Temperature</td>
</tr>
<tr class="even">
<td align="left">THSM_CON</td>
<td align="left">Wet-bulb Temperature</td>
</tr>
<tr class="odd">
<td align="left">TMN_CON</td>
<td align="left">Minimum Temperature</td>
</tr>
<tr class="even">
<td align="left">TMX_CON</td>
<td align="left">Maximum Temperature</td>
</tr>
<tr class="odd">
<td align="left">TSTG_CON</td>
<td align="left">Dry-bulb Temperature (Termograph)</td>
</tr>
<tr class="even">
<td align="left">HR_CAL</td>
<td align="left">Relative Humidity</td>
</tr>
<tr class="odd">
<td align="left">HRHG_CON</td>
<td align="left">Relative Humidity (Hydrograph)</td>
</tr>
<tr class="even">
<td align="left">TV_CAL</td>
<td align="left">Vapour Pressure</td>
</tr>
<tr class="odd">
<td align="left">TPR_CAL</td>
<td align="left">Dew Point</td>
</tr>
<tr class="even">
<td align="left">PTPM_CON</td>
<td align="left">Precipitation (Daily)</td>
</tr>
<tr class="odd">
<td align="left">PTPG_CON</td>
<td align="left">Precipitation (Hourly)</td>
</tr>
<tr class="even">
<td align="left">EVTE_CON</td>
<td align="left">Evaporation</td>
</tr>
<tr class="odd">
<td align="left">FA_CON</td>
<td align="left">Atmospheric Phenomenon</td>
</tr>
<tr class="even">
<td align="left">NB_CON</td>
<td align="left">Cloudiness</td>
</tr>
<tr class="odd">
<td align="left">RCAM_CON</td>
<td align="left">Wind Trajectory</td>
</tr>
<tr class="even">
<td align="left">BSHG_CON</td>
<td align="left">Sunshine Duration</td>
</tr>
<tr class="odd">
<td align="left">VVAG_CON</td>
<td align="left">Wind Speed</td>
</tr>
<tr class="even">
<td align="left">DVAG_CON</td>
<td align="left">Wind Direction</td>
</tr>
<tr class="odd">
<td align="left">VVMXAG_CON</td>
<td align="left">Maximum Wind Speed</td>
</tr>
<tr class="even">
<td align="left">DVMXAG_CON</td>
<td align="left">Maximum Wind Direction</td>
</tr>
</tbody>
</table>
<div style="text-align: justify;">
<p>Each observation is subject to the availability of stations in the
ROI and the stations’ status (active, maintenance or suspended), as well
as quality filters implemented by IDEAM.</p>
<p>In this vignette you will learn: 1. How to download climate data
using <strong>ColOpenData</strong> by three different methods - Download
from named stations - Download from geometry (<code>sf</code>) -
Download from named geometry (municipality or department) 2. How to
aggregate climate data by different frequencies 3. How to plot
downloaded climate data</p>
<p>For this example we will retrieve data for the municipality of
Manizales in Colombia. We will download Maximum Temperature (TMX_CON)
from 2013 to 2016, to observe the increase in temperature during 2015
and 2016 due to the impact of El Nino (ENSO).</p>
<p><strong>ColOpenData</strong> offers three methods to do this, using
three different functions: - <code>download_climate_stations</code> to
download climate data from previously selected stations -
<code>download_climate_geom</code> to download climate data from a
specified geometry (ROI) - <code>download_climate</code> to download
climate data from municipalities’ or departments’ already loaded
geometries</p>
<p>In this example, we will follow the three methods to get the same
results, exploring the included functions. We will start by loading the
needed libraries.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/ColOpenData" class="external-link">ColOpenData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div style="text-align: justify;">
<p><strong>Disclaimer: all data is loaded to the environment in the
user’s R session, but is not downloaded to user’s computer.</strong></p>
</div>
<div class="section level2">
<h2 id="retrieving-climate-data-for-a-roi-using-stations-data">Retrieving climate data for a ROI using stations’ data<a class="anchor" aria-label="anchor" href="#retrieving-climate-data-for-a-roi-using-stations-data"></a>
</h2>
<div style="text-align: justify;">
<p>For this example, we will need to create a spatial polygon around the
municipality of Manizales and use that as our ROI to retrieve the
climate data. To create the spatial polygon we need to introduce the
coordinates of the geometry. For simplicity, we will build a box by
introducing the 4 points which bound the municipality, and transform the
created geometry into an <code>sf</code> object (see <a href="https://r-spatial.github.io/sf/articles/sf1.html" class="external-link"><strong>sf</strong></a>
library for further details). For visualization we will use
<code>leaflet</code>.</p>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define coordinates (bounding box around Manizales)</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.166278</span>, <span class="fl">5.166278</span>, <span class="fl">4.982247</span>, <span class="fl">4.982247</span>, <span class="fl">5.166278</span><span class="op">)</span></span>
<span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75.678072</span>, <span class="op">-</span><span class="fl">75.327859</span>, <span class="op">-</span><span class="fl">75.327859</span>, <span class="op">-</span><span class="fl">75.678072</span>, <span class="op">-</span><span class="fl">75.678072</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use sf to create a polygon and turn it into a geometry</span></span>
<span><span class="va">polygon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Turn geometry into sf object</span></span>
<span><span class="va">roi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">polygon</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot polygon for reference</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="va">roi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span><span class="st">"OpenStreetMap"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons</a></span><span class="op">(</span></span>
<span>    stroke <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    weight <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#2e6930"</span>,</span>
<span>    fillColor <span class="op">=</span> <span class="st">"#2e6930"</span>,</span>
<span>    opacity <span class="op">=</span> <span class="fl">0.6</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[-75.678072,-75.327859,-75.327859,-75.678072,-75.678072],"lat":[5.166278,5.166278,4.982247,4.982247,5.166278]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#2e6930","weight":2,"opacity":0.6,"fill":true,"fillColor":"#2e6930","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[4.982247,5.166278],"lng":[-75.678072,-75.327859]}},"evals":[],"jsHooks":[]}</script><div style="text-align: justify;">
<p>With our new ROI, we can make a first exploration to check if there
are any stations contained inside of it, using the function
<code>stations_in_roi</code></p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stations_in_roi.html">stations_in_roi</a></span><span class="op">(</span><span class="va">roi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stations</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 20 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -75.51667 ymin: 5.029778 xmax: -75.35611 ymax: 5.1</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt;        codigo                           nombre           categoria</span></span>
<span><span class="co">#&gt; 138  26155220      VILLAMARIA - AUT [26155220] Climática Principal</span></span>
<span><span class="co">#&gt; 139  26155210         TORRE 4 - AUT [26155210] Climática Principal</span></span>
<span><span class="co">#&gt; 140  26155230            EMAS - AUT [26155230] Climática Principal</span></span>
<span><span class="co">#&gt; 266  26155110   AEROPUERTO LA NUBIA [26155110] Sinóptica Principal</span></span>
<span><span class="co">#&gt; 749  26155170 TESORITO FINCA  - AUT [26155170] Climática Ordinaria</span></span>
<span><span class="co">#&gt; 1119 26157090              PLAYA LA [26157090]        Limnimétrica</span></span>
<span><span class="co">#&gt;                     tecnologia     estado departamento  municipio  latitud</span></span>
<span><span class="co">#&gt; 138  Automática con Telemetría     Activa       Caldas Villamaria 5.048667</span></span>
<span><span class="co">#&gt; 139  Automática con Telemetría Suspendida       Caldas  Manizales 5.060778</span></span>
<span><span class="co">#&gt; 140  Automática con Telemetría     Activa       Caldas  Manizales 5.085250</span></span>
<span><span class="co">#&gt; 266               Convencional     Activa       Caldas  Manizales 5.029778</span></span>
<span><span class="co">#&gt; 749  Automática con Telemetría     Activa       Caldas  Manizales 5.032222</span></span>
<span><span class="co">#&gt; 1119              Convencional Suspendida       Caldas  Manizales 5.100000</span></span>
<span><span class="co">#&gt;       longitud altitud   fecha_instalacion</span></span>
<span><span class="co">#&gt; 138  -75.51389    1906 2004-06-14 00:00:00</span></span>
<span><span class="co">#&gt; 139  -75.35611    3787 2004-07-14 00:00:00</span></span>
<span><span class="co">#&gt; 140  -75.50714    2211 2004-06-10 00:00:00</span></span>
<span><span class="co">#&gt; 266  -75.46992    2104 1968-06-15 00:00:00</span></span>
<span><span class="co">#&gt; 749  -75.43833    2325 1992-10-14 19:00:00</span></span>
<span><span class="co">#&gt; 1119 -75.51667     250 1984-07-15 00:00:00</span></span>
<span><span class="co">#&gt;                              area_operativa         corriente area_hidrografica</span></span>
<span><span class="co">#&gt; 138  Area Operativa 09 - Cauca-Valle-Caldas          San Juan   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 139  Area Operativa 09 - Cauca-Valle-Caldas          San Juan   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 140  Area Operativa 09 - Cauca-Valle-Caldas          San Juan   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 266  Area Operativa 09 - Cauca-Valle-Caldas           Orinoco   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 749  Area Operativa 09 - Cauca-Valle-Caldas                 0   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 1119 Area Operativa 09 - Cauca-Valle-Caldas Quebrada Olivares   Magdalena Cauca</span></span>
<span><span class="co">#&gt;      zona_hidrografica subzona_hidrografica</span></span>
<span><span class="co">#&gt; 138              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 139    Medio Magdalena          Río Guarinó</span></span>
<span><span class="co">#&gt; 140              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 266              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 749              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 1119             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt;                                                          entidad</span></span>
<span><span class="co">#&gt; 138  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 139  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 140  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 266  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 749  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 1119 INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt;      fecha_suspension mpio_cdpmp dpto_ccdgo                   geometry</span></span>
<span><span class="co">#&gt; 138              &lt;NA&gt;      17873         17 POINT (-75.51389 5.048667)</span></span>
<span><span class="co">#&gt; 139        2010-09-29      17446         17 POINT (-75.35611 5.060778)</span></span>
<span><span class="co">#&gt; 140              &lt;NA&gt;      17001         17  POINT (-75.50714 5.08525)</span></span>
<span><span class="co">#&gt; 266              &lt;NA&gt;      17001         17 POINT (-75.46992 5.029778)</span></span>
<span><span class="co">#&gt; 749              &lt;NA&gt;      17001         17 POINT (-75.43833 5.032222)</span></span>
<span><span class="co">#&gt; 1119       1996-04-15      17001         17      POINT (-75.51667 5.1)</span></span></code></pre></div>
<div style="text-align: justify;">
<p>We can see that in the region there are 129 stations. Different
categories are recorded by different stations, and can be checked at the
column <u>categoria</u>. To understand the category of each station we
can use the definition catalog provided by IDEAM <a href="http://www.ideam.gov.co/documents/10182/557765/Definiciones+CNE.pdf/25e1cca5-ee47-4eaf-86c0-c4f5192a9937" class="external-link">here</a>.
Stations under the categories <em>Climática Principal</em> and
<em>Climática Ordinaria</em> have records of temperature.</p>
<p>Some stations are suspended, which means they are not taking
measurements at the moment. This information is found at the column
<u>estado,</u> where if suspended the observation would be
<em>Suspendida.</em> Also, at the column <u>fecha_suspension</u> the
observation would be different from <code>NA</code>, since active
stations do not have a suspension date. However, even if a station is
suspended, the historical data (up to the suspension date) can be
accessed.</p>
<p>To filter the stations that recorded information during the desired
period, we can delete the stations with suspension dates before
2013.</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Working stations after 2013</span></span>
<span><span class="va">w_stations</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">fecha_suspension</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2013-01-01"</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="va">estado</span> <span class="op">==</span> <span class="st">"Activa"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filtering for categories</span></span>
<span><span class="va">cw_stations</span> <span class="op">&lt;-</span> <span class="va">w_stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">categoria</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Climática Principal"</span>, <span class="st">"Climática Ordinaria"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># General information of stations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cw_stations</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 20 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -75.66667 ymin: 5.017778 xmax: -75.35658 ymax: 5.08525</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt;       codigo                                      nombre           categoria</span></span>
<span><span class="co">#&gt; 1   26155220                 VILLAMARIA - AUT [26155220] Climática Principal</span></span>
<span><span class="co">#&gt; 2   26155230                       EMAS - AUT [26155230] Climática Principal</span></span>
<span><span class="co">#&gt; 3   26155170            TESORITO FINCA  - AUT [26155170] Climática Ordinaria</span></span>
<span><span class="co">#&gt; 4 2615500122 LA ESPERANZA ANDALUCIA - AUT   [2615500122] Climática Principal</span></span>
<span><span class="co">#&gt; 5   26155190                    ALGARROBO EL  [26155190] Climática Principal</span></span>
<span><span class="co">#&gt; 6   26155090                      SANTAGUEDA  [26155090] Climática Principal</span></span>
<span><span class="co">#&gt;                  tecnologia estado departamento          municipio  latitud</span></span>
<span><span class="co">#&gt; 1 Automática con Telemetría Activa       Caldas         Villamaria 5.048667</span></span>
<span><span class="co">#&gt; 2 Automática con Telemetría Activa       Caldas          Manizales 5.085250</span></span>
<span><span class="co">#&gt; 3 Automática con Telemetría Activa       Caldas          Manizales 5.032222</span></span>
<span><span class="co">#&gt; 4 Automática con Telemetría Activa       Caldas          Manizales 5.017778</span></span>
<span><span class="co">#&gt; 5              Convencional Activa       Caldas          Manizales 5.066667</span></span>
<span><span class="co">#&gt; 6              Convencional Activa       Caldas Palestina (Caldas) 5.083333</span></span>
<span><span class="co">#&gt;    longitud altitud   fecha_instalacion                         area_operativa</span></span>
<span><span class="co">#&gt; 1 -75.51389    1906 2004-06-14 00:00:00 Area Operativa 09 - Cauca-Valle-Caldas</span></span>
<span><span class="co">#&gt; 2 -75.50714    2211 2004-06-10 00:00:00 Area Operativa 09 - Cauca-Valle-Caldas</span></span>
<span><span class="co">#&gt; 3 -75.43833    2325 1992-10-14 19:00:00 Area Operativa 09 - Cauca-Valle-Caldas</span></span>
<span><span class="co">#&gt; 4 -75.35658    3316 2017-04-19 19:00:00 Area Operativa 09 - Cauca-Valle-Caldas</span></span>
<span><span class="co">#&gt; 5 -75.58333    1202 1992-11-15 00:00:00 Area Operativa 09 - Cauca-Valle-Caldas</span></span>
<span><span class="co">#&gt; 6 -75.66667    1010 1964-01-15 00:00:00 Area Operativa 09 - Cauca-Valle-Caldas</span></span>
<span><span class="co">#&gt;           corriente area_hidrografica zona_hidrografica subzona_hidrografica</span></span>
<span><span class="co">#&gt; 1          San Juan   Magdalena Cauca             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 2          San Juan   Magdalena Cauca             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 3                 0   Magdalena Cauca             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 4                 0   Magdalena Cauca             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 5 Qda Santa Barbara   Magdalena Cauca             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 6 Qda Santa Barbara   Magdalena Cauca             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt;                                                       entidad fecha_suspension</span></span>
<span><span class="co">#&gt; 1 INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2 INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3 INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4 INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                            FEDERACION NACIONAL DE CAFETEROS             &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                            FEDERACION NACIONAL DE CAFETEROS             &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   mpio_cdpmp dpto_ccdgo                   geometry</span></span>
<span><span class="co">#&gt; 1      17873         17 POINT (-75.51389 5.048667)</span></span>
<span><span class="co">#&gt; 2      17001         17  POINT (-75.50714 5.08525)</span></span>
<span><span class="co">#&gt; 3      17001         17 POINT (-75.43833 5.032222)</span></span>
<span><span class="co">#&gt; 4      17001         17 POINT (-75.35658 5.017778)</span></span>
<span><span class="co">#&gt; 5      17001         17 POINT (-75.58333 5.066667)</span></span>
<span><span class="co">#&gt; 6      17524         17 POINT (-75.66667 5.083333)</span></span></code></pre></div>
<div style="text-align: justify;">
<p>From the original 129 stations, 40 were working for some or the whole
period of interest and collected information for Dry-bulb Temperature
(TSSM_CON). It is important to consider that after data collection, some
information might be lost due to quality attributes.</p>
<p>With the stations, we can access TMX_CON from 2013 to 2016. To do so,
we can use the function <code>download_climate_stations</code>. This
function has the following parameters:</p>
<ul>
<li>
<code>stations</code>: <code>data.frame</code> containing the
stations’ codes. This <code>data.frame</code> must be retrieved from the
function <code>stations_in_roi</code>.</li>
<li>
<code>start_date</code>: character with the first date to consult in
the format <code>"YYYY-MM-DD"</code>.</li>
<li>
<code>end_date</code>: character with the last date to consult in
the format <code>"YYYY-MM_DD"</code>. (Last available date is
<code>"2023-05-31"</code>).</li>
<li>
<code>tag</code>: character containing climate tag to consult.</li>
</ul>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_temperature_stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_climate_stations.html">download_climate_stations</a></span><span class="op">(</span></span>
<span>  stations <span class="op">=</span> <span class="va">w_stations</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2016-12-31"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"TMX_CON"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Original data is retrieved from the Institute of Hydrology, Meteorology</span></span>
<span><span class="co">#&gt; and Environmental Studies (Instituto de Hidrología, Meteorología y</span></span>
<span><span class="co">#&gt; Estudios Ambientales - IDEAM).</span></span>
<span><span class="co">#&gt; Reformatted by package authors.</span></span>
<span><span class="co">#&gt; Stored by Universidad de Los Andes under the Epiverse TRACE iniative.</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">max_temperature_stations</span><span class="op">)</span></span>
<span><span class="co">#&gt;    station longitude latitude       date     hour     tag value</span></span>
<span><span class="co">#&gt; 1 26155110 -75.46992 5.029778 2013-01-01 19:00:00 TMX_CON  22.2</span></span>
<span><span class="co">#&gt; 2 26155110 -75.46992 5.029778 2013-01-02 19:00:00 TMX_CON  21.0</span></span>
<span><span class="co">#&gt; 3 26155110 -75.46992 5.029778 2013-01-03 19:00:00 TMX_CON  23.0</span></span>
<span><span class="co">#&gt; 4 26155110 -75.46992 5.029778 2013-01-04 19:00:00 TMX_CON  22.8</span></span>
<span><span class="co">#&gt; 5 26155110 -75.46992 5.029778 2013-01-05 19:00:00 TMX_CON  23.6</span></span>
<span><span class="co">#&gt; 6 26155110 -75.46992 5.029778 2013-01-06 19:00:00 TMX_CON  22.4</span></span></code></pre></div>
<div style="text-align: justify;">
<p>The returned tidy <code>data.frame</code> includes: individual and
unique station code, longitude, latitude, date, hour, tag requested and
value recorded at the specified time. The tidy structure reports a row
for each observation, which makes the subset and plot easier.</p>
<p>To plot a time series of the stations’ data we can use
<code>ggplot2</code> as follows:</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">max_temperature_stations</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">station</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Max Temperature in Manizales by station"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Temperature [°C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">station</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/plot%20temperatures%20stations-1.png" width="700"></p>
<div style="text-align: justify;">
<p>As we can see, only two stations have data for the selected period,
and we have missing information in some periods. Additionally, by having
the data daily we cannot easily see big changes along time. To aid this
issue, we will use the aggregation function
<code>aggregate_climate</code>, which aggregates climate data by time.
This function takes by parameter the desired aggregation.</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_temperature_month</span> <span class="op">&lt;-</span> <span class="va">max_temperature_stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregate_climate.html">aggregate_climate</a></span><span class="op">(</span><span class="st">"month"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">max_temperature_month</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">station</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dry-bulb Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dry-bulb temperature [C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">station</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="retrieving-climate-data-for-a-roi">Retrieving climate data for a ROI<a class="anchor" aria-label="anchor" href="#retrieving-climate-data-for-a-roi"></a>
</h2>
<div style="text-align: justify;">
<p>To retrieve climate data for any ROI in the country, without manually
extracting the stations’ data, we can use the function
<code>download_climate_geom</code>. The function has the following
parameters:</p>
<ul>
<li>
<code>geometry</code>: <code>sf</code> geometry containing the
geometry for a given ROI. This geometry can be either a
<code>POLYGON</code> or <code>MULTIPOLYGON</code>.</li>
<li>
<code>start_date</code>: character with the first date to consult in
the format <code>"YYYY-MM-DD"</code>.</li>
<li>
<code>end_date</code>: character with the last date to consult in
the format <code>"YYYY-MM_DD"</code>. (Last available date is
<code>"2023-05-31"</code>).</li>
<li>
<code>tag</code>: character containing climate tag to consult.</li>
</ul>
<p>We will use the same ROI created for the previous example, and add
the aggregation for month. We can add the aggregation function to the
workflow using the pipe operator <code>%&gt;%</code>.</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_temperature_roi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_climate_geom.html">download_climate_geom</a></span><span class="op">(</span></span>
<span>  geometry <span class="op">=</span> <span class="va">roi</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2016-12-31"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"TMX_CON"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregate_climate.html">aggregate_climate</a></span><span class="op">(</span><span class="st">"month"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">max_temperature_roi</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">station</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dry-bulb Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dry-bulb temperature [C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">station</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/plot%20temperatures%20roi-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="retrieving-climate-data-for-municipality">Retrieving climate data for municipality<a class="anchor" aria-label="anchor" href="#retrieving-climate-data-for-municipality"></a>
</h2>
<div style="text-align: justify;">
<p>To make the download process even easier, and avoid the creation of
already known geometries like municipalities or departments,
<strong>ColOpenData</strong> offers an extra function to download data
using the areas’ DIVIPOLA code.</p>
<p>DIVIPOLA codification is standardized for the whole country, and
contains department’s and municipalities’ codes. Departments have two
digits for individual identification, while municipalities have five.
The codes for each municipality and department can be consulted in the
following <a href="https://www.datos.gov.co/widgets/gdxc-w37w" class="external-link">table</a>.</p>
<p>To get the DIVIPOLA code of a municipality or department we can use
the auxiliary functions <code>divipola_municipality_code</code> and
<code>divipola_department_code</code> in <strong>ColOpenData</strong>.
To retrieve a municipality code we must include the department name and
the municipality name. This is to consider repetition in municipalities’
names across departments.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/divipola_municipality_code.html">divipola_municipality_code</a></span><span class="op">(</span><span class="st">"CALDAS"</span>, <span class="st">"MANIZALES"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "17001"</span></span></code></pre></div>
<p>To replicate our previous example we only need the code for
Manizales, which is “17001”. This means the code for the department
Caldas (where Manizales is located) is “17” and the code for Manizales
inside that department is “001”.</p>
<p>The function <code>download_climate</code> will require almost the
same arguments as <code>download_climate_geom</code>, but instead of an
<code>sf</code> object, it will take a character containing the DIVIPOLA
code:</p>
<ul>
<li>
<code>code</code>: character with the DIVIPOLA code for the
area.</li>
<li>
<code>start_date</code>: character with the first date to consult in
the format <code>"YYYY-MM-DD"</code>.</li>
<li>
<code>end_date</code>: character with the last date to consult in
the format <code>"YYYY-MM_DD"</code>. (Last available date is
<code>"2023-05-31"</code>).</li>
<li>
<code>tag</code>: character containing climate tag to consult.</li>
</ul>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">max_temperature_mpio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_climate.html">download_climate</a></span><span class="op">(</span></span>
<span>  code <span class="op">=</span> <span class="st">"17001"</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2016-12-31"</span>,</span>
<span>  tag <span class="op">=</span> <span class="st">"TMX_CON"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/aggregate_climate.html">aggregate_climate</a></span><span class="op">(</span><span class="st">"month"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">max_temperature_mpio</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">station</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dry-bulb Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dry-bulb temperature [C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">station</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/plot%20temperatures%20mpios-1.png" width="700"></p>
<div style="text-align: justify;">
<p>As stated at the beginning of this vignette, the three methods
display the same results.</p>
</div>
</div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<div style="text-align: justify;">
<ul>
<li><p>Data availability is subdued to station’s measurements and
quality filters. In most cases, this leads to a lower amount of data,
considering the extensive amount of climate stations.</p></li>
<li>
<p>Temporal aggregation is only available for some tags and is
limited to the ones who have a specific methodology of aggregation
reported by IDEAM. The daily, monthly and annual aggregation is
available for:</p>
<ul>
<li>
<code>TSSM_CON</code>: Dry-bulb temperature</li>
<li>
<code>TMX_CON</code>: Maximum temperature</li>
<li>
<code>TMN_CON</code>: Minimum temperature</li>
<li>
<code>PTPM_CON</code>: Precipitation</li>
<li>
<code>BSHG_CON</code>: Sunshine duration</li>
</ul>
</li>
<li><p>Temporal and spatial interpolation are not included in this
version of <strong>ColOpenData</strong>.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>
    <footer><div class="pkgdown-footer-left">
  <p>Developed by M. Camila Tavera-Cifuentes, Julian Otero, Juan D. Umana, Juan Montenegro-Torres.</p>
</div>
<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>
    </footer>
</div>
  </body>
</html>
