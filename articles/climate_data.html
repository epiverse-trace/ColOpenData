<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ColOpenData">
<title>How to download climate data using ColOpenData • ColOpenData</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to download climate data using ColOpenData">
<meta property="og:description" content="ColOpenData">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">ColOpenData</a>

    <small class="nav-text text-muted me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/climate_data.html">How to download climate data using ColOpenData</a>
    <a class="dropdown-item" href="../articles/demographic_data.html">A Deep Dive into Colombian Demographics Using ColOpenData</a>
    <a class="dropdown-item" href="../articles/documentation_and_dictionaries.html">Documentation and Dictionaries</a>
    <a class="dropdown-item" href="../articles/geospatial_data.html">Maps and plots with ColOpenData</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/ColOpenData/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="climate_data_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="climate_data_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="climate_data_files/leaflet-1.3.1/leaflet.js"></script><link href="climate_data_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="climate_data_files/proj4-2.6.2/proj4.min.js"></script><script src="climate_data_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="climate_data_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="climate_data_files/leaflet-binding-2.2.1/leaflet.js"></script><script src="climate_data_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="climate_data_files/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>How to download climate data using ColOpenData</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/ColOpenData/blob/HEAD/vignettes/climate_data.Rmd" class="external-link"><code>vignettes/climate_data.Rmd</code></a></small>
      <div class="d-none name"><code>climate_data.Rmd</code></div>
    </div>

    
    
<p><strong>ColOpenData</strong> can be used to access open climate data
from Colombia. This climate data is retrieved from the Institute of
Hydrology, Meteorology and Environmental Studies <a href="http://www.ideam.gov.co/" class="external-link">(IDEAM)</a>. The climate module allows
the user to consult climate data for any Region of Interest (ROI) inside
the country and aggregate for different frequencies like day, week,
month or year.</p>
<p>The available information from IDEAM can be accessed using specific
internal tags as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Tags</th>
<th align="left">Variable</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TSSM_CON</td>
<td align="left">Dry-bulb Temperature</td>
</tr>
<tr class="even">
<td align="left">THSM_CON</td>
<td align="left">Wet-bulb Temperature</td>
</tr>
<tr class="odd">
<td align="left">TMN_CON</td>
<td align="left">Minimum Temperature</td>
</tr>
<tr class="even">
<td align="left">TMX_CON</td>
<td align="left">Maximum Temperature</td>
</tr>
<tr class="odd">
<td align="left">TSTG_CON</td>
<td align="left">Dry-bulb Temperature (Termograph)</td>
</tr>
<tr class="even">
<td align="left">HR_CAL</td>
<td align="left">Relative Humidity</td>
</tr>
<tr class="odd">
<td align="left">HRHG_CON</td>
<td align="left">Relative Humidity (Hydrograph)</td>
</tr>
<tr class="even">
<td align="left">TV_CAL</td>
<td align="left">Vapour Pressure</td>
</tr>
<tr class="odd">
<td align="left">TPR_CAL</td>
<td align="left">Dew Point</td>
</tr>
<tr class="even">
<td align="left">PTPM_CON</td>
<td align="left">Precipitation (Daily)</td>
</tr>
<tr class="odd">
<td align="left">PTPG_CON</td>
<td align="left">Precipitation (Hourly)</td>
</tr>
<tr class="even">
<td align="left">EVTE_CON</td>
<td align="left">Evaporation</td>
</tr>
<tr class="odd">
<td align="left">FA_CON</td>
<td align="left">Atmospheric Phenomenon</td>
</tr>
<tr class="even">
<td align="left">NB_CON</td>
<td align="left">Cloudiness</td>
</tr>
<tr class="odd">
<td align="left">RCAM_CON</td>
<td align="left">Wind Trajectory</td>
</tr>
<tr class="even">
<td align="left">BSHG_CON</td>
<td align="left">Solar Luminosity</td>
</tr>
<tr class="odd">
<td align="left">VVAG_CON</td>
<td align="left">Wind Speed</td>
</tr>
<tr class="even">
<td align="left">DVAG_CON</td>
<td align="left">Wind Direction</td>
</tr>
<tr class="odd">
<td align="left">VVMXAG_CON</td>
<td align="left">Maximum Wind Speed</td>
</tr>
<tr class="even">
<td align="left">DVMXAG_CON</td>
<td align="left">Maximum Wind Direction</td>
</tr>
</tbody>
</table>
<p>Each observation is subject to to the availability of stations in the
ROI and the stations’ status (active, maintenance or suspended).</p>
<p>For this example we will retrieve data for the city of Manizales in
Colombia. We will download Dry-bulb temperature from 2013 to 2016, to
observe the increase in temperature during 2015 and 2016 due to the
impact of El Nino (ENSO).</p>
<p>We will start by loading the necessary libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/ColOpenData" class="external-link">ColOpenData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="retrieving-climate-data-for-a-region-of-interest-roi-using-stations-data">Retrieving climate data for a Region of Interest (ROI) using
stations’ data<a class="anchor" aria-label="anchor" href="#retrieving-climate-data-for-a-region-of-interest-roi-using-stations-data"></a>
</h2>
<p>For this example, we will need to create a spatial polygon around the
city of Manizales and use that as our ROI to retrieve the climate data.
To create the spatial polygon we need to introduce the coordinates of
the geometry. For simplicity, we will build a box by introducing the 4
points which bound the box, and transform the created geometry into an
<code>sf</code> object (see <a href="https://r-spatial.github.io/sf/articles/sf1.html" class="external-link"><strong>sf</strong></a>
library for further details). For visualization we will use
<strong>leaflet</strong>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define coordinates (Bounding box around Manizales)</span></span>
<span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.166278</span>, <span class="fl">5.166278</span>, <span class="fl">4.982247</span>, <span class="fl">4.982247</span>, <span class="fl">5.166278</span><span class="op">)</span></span>
<span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">75.678072</span>, <span class="op">-</span><span class="fl">75.327859</span>, <span class="op">-</span><span class="fl">75.327859</span>, <span class="op">-</span><span class="fl">75.678072</span>, <span class="op">-</span><span class="fl">75.678072</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use sf to create a polygon and turn it into a geometry</span></span>
<span><span class="va">polygon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Turn geometry into sf object</span></span>
<span><span class="va">roi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">polygon</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot polygon for reference</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span><span class="va">roi</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span><span class="st">"OpenStreetMap"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons</a></span><span class="op">(</span></span>
<span>    stroke <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    weight <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"#2e6930"</span>,</span>
<span>    fillColor <span class="op">=</span> <span class="st">"#2e6930"</span>,</span>
<span>    opacity <span class="op">=</span> <span class="fl">0.6</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-6903f9aa9875aaf9eb8e" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-6903f9aa9875aaf9eb8e">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolygons","args":[[[[{"lng":[-75.678072,-75.327859,-75.327859,-75.678072,-75.678072],"lat":[5.166278,5.166278,4.982247,4.982247,5.166278]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#2e6930","weight":2,"opacity":0.6,"fill":true,"fillColor":"#2e6930","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[4.982247,5.166278],"lng":[-75.678072,-75.327859]}},"evals":[],"jsHooks":[]}</script><p>With our new ROI, we can make a first exploration to check if there
are any stations contained inside of it, using the function
<code>stations_in_roi</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stations_in_roi.html">stations_in_roi</a></span><span class="op">(</span><span class="va">roi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stations</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 20 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -75.51667 ymin: 5.029778 xmax: -75.35611 ymax: 5.1</span></span>
<span><span class="co">#&gt; CRS:           NA</span></span>
<span><span class="co">#&gt;        codigo                           nombre           categoria</span></span>
<span><span class="co">#&gt; 138  26155220      VILLAMARIA - AUT [26155220] Climática Principal</span></span>
<span><span class="co">#&gt; 139  26155210         TORRE 4 - AUT [26155210] Climática Principal</span></span>
<span><span class="co">#&gt; 140  26155230            EMAS - AUT [26155230] Climática Principal</span></span>
<span><span class="co">#&gt; 266  26155110   AEROPUERTO LA NUBIA [26155110] Sinóptica Principal</span></span>
<span><span class="co">#&gt; 749  26155170 TESORITO FINCA  - AUT [26155170] Climática Ordinaria</span></span>
<span><span class="co">#&gt; 1119 26157090              PLAYA LA [26157090]        Limnimétrica</span></span>
<span><span class="co">#&gt;                     tecnologia     estado departamento  municipio  latitud</span></span>
<span><span class="co">#&gt; 138  Automática con Telemetría     Activa       Caldas Villamaria 5.048667</span></span>
<span><span class="co">#&gt; 139  Automática con Telemetría Suspendida       Caldas  Manizales 5.060778</span></span>
<span><span class="co">#&gt; 140  Automática con Telemetría     Activa       Caldas  Manizales 5.085250</span></span>
<span><span class="co">#&gt; 266               Convencional     Activa       Caldas  Manizales 5.029778</span></span>
<span><span class="co">#&gt; 749  Automática con Telemetría     Activa       Caldas  Manizales 5.032222</span></span>
<span><span class="co">#&gt; 1119              Convencional Suspendida       Caldas  Manizales 5.100000</span></span>
<span><span class="co">#&gt;       longitud altitud   fecha_instalacion</span></span>
<span><span class="co">#&gt; 138  -75.51389    1906 2004-06-14 00:00:00</span></span>
<span><span class="co">#&gt; 139  -75.35611    3787 2004-07-14 00:00:00</span></span>
<span><span class="co">#&gt; 140  -75.50714    2211 2004-06-10 00:00:00</span></span>
<span><span class="co">#&gt; 266  -75.46992    2104 1968-06-15 00:00:00</span></span>
<span><span class="co">#&gt; 749  -75.43833    2325 1992-10-14 19:00:00</span></span>
<span><span class="co">#&gt; 1119 -75.51667     250 1984-07-15 00:00:00</span></span>
<span><span class="co">#&gt;                              area_operativa         corriente area_hidrografica</span></span>
<span><span class="co">#&gt; 138  Area Operativa 09 - Cauca-Valle-Caldas          San Juan   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 139  Area Operativa 09 - Cauca-Valle-Caldas          San Juan   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 140  Area Operativa 09 - Cauca-Valle-Caldas          San Juan   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 266  Area Operativa 09 - Cauca-Valle-Caldas           Orinoco   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 749  Area Operativa 09 - Cauca-Valle-Caldas                 0   Magdalena Cauca</span></span>
<span><span class="co">#&gt; 1119 Area Operativa 09 - Cauca-Valle-Caldas Quebrada Olivares   Magdalena Cauca</span></span>
<span><span class="co">#&gt;      zona_hidrografica subzona_hidrografica</span></span>
<span><span class="co">#&gt; 138              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 139    Medio Magdalena          Río Guarinó</span></span>
<span><span class="co">#&gt; 140              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 266              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 749              Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt; 1119             Cauca        Río Chinchiná</span></span>
<span><span class="co">#&gt;                                                          entidad</span></span>
<span><span class="co">#&gt; 138  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 139  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 140  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 266  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 749  INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt; 1119 INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES</span></span>
<span><span class="co">#&gt;      fecha_suspension mpio_cdpmp dpto_ccdgo                   geometry</span></span>
<span><span class="co">#&gt; 138              &lt;NA&gt;      17873         17 POINT (-75.51389 5.048667)</span></span>
<span><span class="co">#&gt; 139        2010-09-29      17446         17 POINT (-75.35611 5.060778)</span></span>
<span><span class="co">#&gt; 140              &lt;NA&gt;      17001         17  POINT (-75.50714 5.08525)</span></span>
<span><span class="co">#&gt; 266              &lt;NA&gt;      17001         17 POINT (-75.46992 5.029778)</span></span>
<span><span class="co">#&gt; 749              &lt;NA&gt;      17001         17 POINT (-75.43833 5.032222)</span></span>
<span><span class="co">#&gt; 1119       1996-04-15      17001         17      POINT (-75.51667 5.1)</span></span></code></pre></div>
<p>We can see that in the region there are 129 stations. Different
categories are recorded by different stations, and can be checked at the
column <em>categoria</em>. To understand the category of each station we
can use the definition catalog provided by DANE <a href="http://www.ideam.gov.co/documents/10182/557765/Definiciones+CNE.pdf/25e1cca5-ee47-4eaf-86c0-c4f5192a9937" class="external-link">here</a>.
Stations under the categories <em>Climática Principal</em> and
<em>Climática Ordinaria</em> have records of Dry-bulb temperature.</p>
<p>Some stations are suspended, which means they are not taking
measurements at the moment. This information is found at the column
<u>estado</u> or, if the observation at <u>fecha_suspension</u> is
different from <code>NA</code>, since active stations do not have a
suspension date. However, even if a station is suspended, the historical
data (up to the suspension date) can be accessed.</p>
<p>To filter the stations that recorded information during the desired
period, we can delete the stations with suspension dates before
2013.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Working stations after 2013</span></span>
<span><span class="va">w_stations</span> <span class="op">&lt;-</span> <span class="va">stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">fecha_suspension</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2013-01-01"</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="va">estado</span> <span class="op">==</span> <span class="st">"Activa"</span><span class="op">)</span></span>
<span><span class="co"># Filtering for categories</span></span>
<span><span class="va">cw_stations</span> <span class="op">&lt;-</span> <span class="va">w_stations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">categoria</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Climática Principal"</span>, <span class="st">"Climática Ordinaria"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># General information of stations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cw_stations</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classes 'sf' and 'data.frame':   40 obs. of  21 variables:</span></span>
<span><span class="co">#&gt;  $ codigo              : num  2.62e+07 2.62e+07 2.62e+07 2.62e+09 2.62e+07 ...</span></span>
<span><span class="co">#&gt;  $ nombre              : chr  "VILLAMARIA - AUT [26155220]" "EMAS - AUT [26155230]" "TESORITO FINCA  - AUT [26155170]" "LA ESPERANZA ANDALUCIA - AUT   [2615500122]" ...</span></span>
<span><span class="co">#&gt;  $ categoria           : chr  "Climática Principal" "Climática Principal" "Climática Ordinaria" "Climática Principal" ...</span></span>
<span><span class="co">#&gt;  $ tecnologia          : chr  "Automática con Telemetría" "Automática con Telemetría" "Automática con Telemetría" "Automática con Telemetría" ...</span></span>
<span><span class="co">#&gt;  $ estado              : chr  "Activa" "Activa" "Activa" "Activa" ...</span></span>
<span><span class="co">#&gt;  $ departamento        : chr  "Caldas" "Caldas" "Caldas" "Caldas" ...</span></span>
<span><span class="co">#&gt;  $ municipio           : chr  "Villamaria" "Manizales" "Manizales" "Manizales" ...</span></span>
<span><span class="co">#&gt;  $ latitud             : num  5.05 5.09 5.03 5.02 5.07 ...</span></span>
<span><span class="co">#&gt;  $ longitud            : num  -75.5 -75.5 -75.4 -75.4 -75.6 ...</span></span>
<span><span class="co">#&gt;  $ altitud             : num  1906 2211 2325 3316 1202 ...</span></span>
<span><span class="co">#&gt;  $ fecha_instalacion   : POSIXct, format: "2004-06-14 00:00:00" "2004-06-10 00:00:00" ...</span></span>
<span><span class="co">#&gt;  $ area_operativa      : chr  "Area Operativa 09 - Cauca-Valle-Caldas" "Area Operativa 09 - Cauca-Valle-Caldas" "Area Operativa 09 - Cauca-Valle-Caldas" "Area Operativa 09 - Cauca-Valle-Caldas" ...</span></span>
<span><span class="co">#&gt;  $ corriente           : chr  "San Juan" "San Juan" "0" "0" ...</span></span>
<span><span class="co">#&gt;  $ area_hidrografica   : chr  "Magdalena Cauca" "Magdalena Cauca" "Magdalena Cauca" "Magdalena Cauca" ...</span></span>
<span><span class="co">#&gt;  $ zona_hidrografica   : chr  "Cauca" "Cauca" "Cauca" "Cauca" ...</span></span>
<span><span class="co">#&gt;  $ subzona_hidrografica: chr  "Río Chinchiná" "Río Chinchiná" "Río Chinchiná" "Río Chinchiná" ...</span></span>
<span><span class="co">#&gt;  $ entidad             : chr  "INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES" "INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES" "INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES" "INSTITUTO DE HIDROLOGIA METEOROLOGIA Y ESTUDIOS AMBIENTALES" ...</span></span>
<span><span class="co">#&gt;  $ fecha_suspension    : chr  NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ mpio_cdpmp          : chr  "17873" "17001" "17001" "17001" ...</span></span>
<span><span class="co">#&gt;  $ dpto_ccdgo          : chr  "17" "17" "17" "17" ...</span></span>
<span><span class="co">#&gt;  $ geometry            :sfc_POINT of length 40; first list element:  'XY' num  -75.51 5.05</span></span>
<span><span class="co">#&gt;  - attr(*, "sf_column")= chr "geometry"</span></span>
<span><span class="co">#&gt;  - attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:20] "codigo" "nombre" "categoria" "tecnologia" ...</span></span></code></pre></div>
<p>From the original 129 stations, 40 were working for some or the whole
period of interest and collected information for Dry-bulb temperature.
With this information, we can access the Dry-bulb temperature from 2013
to 2016. To do so, we can use the function
<code>download_climate_stations</code>. This function has the following
parameters:</p>
<ul>
<li>
<code>stations</code> numeric vector containing the stations’
codes</li>
<li>
<code>start_date</code>: character with the first date to consult in
the format <code>"YYYY-MM-DD"</code>
</li>
<li>
<code>end_date</code>: character with the last date to consult in
the format <code>"YYYY-MM_DD"</code>. (Last available date is
<code>"2023-05-31"</code>
</li>
<li>
<code>frequency</code>: character with the aggregation frequency.
(<code>"day"</code>, <code>"week"</code>, <code>"month"</code> or
<code>"year"</code>)</li>
<li>
<code>tags</code>: character containing climate tags to consult</li>
<li>
<code>aggregate</code>: logical for data aggregation, if
<code>FALSE</code>, returns the data from each individual station in the
area. (Default = <code>TRUE</code>)</li>
</ul>
<p>Stations’ codes are obtained from the column <code>codigo</code> in
the stations data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_temperature_stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_climate_stations.html">download_climate_stations</a></span><span class="op">(</span></span>
<span>  stations <span class="op">=</span> <span class="va">w_stations</span><span class="op">$</span><span class="va">codigo</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2016-12-31"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  tags <span class="op">=</span> <span class="st">"TSSM_CON"</span>,</span>
<span>  aggregate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the stations’ downloaded data we can plot the time series for
the four years of interest.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">db_temperature_stations</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">TSSM_CON</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dry-bulb Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dry-bulb temperature [C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/plot%20temperatures%20stations-1.png" width="700"></p>
<p>The warning obtained indicates that there were no records for 61 of
the consulted days. This might be due to stations being under
maintenance.</p>
</div>
<div class="section level2">
<h2 id="retrieving-climate-data-for-a-region-of-interest-roi">Retrieving climate data for a Region of Interest (ROI)<a class="anchor" aria-label="anchor" href="#retrieving-climate-data-for-a-region-of-interest-roi"></a>
</h2>
<p>To retrieve climate data for any ROI in the country, without manually
manipulating the stations’ data, we can use the function
<code>download_climate_geom</code>. The function has the following
parameters:</p>
<ul>
<li>
<code>geometry</code>: <code>sf</code> geometry containing the
geometry for a given ROI. This geometry can be either a
<code>POLYGON</code> or <code>MULTIPOLYGON</code>
</li>
<li>
<code>start_date</code>: character with the first date to consult in
the format <code>"YYYY-MM-DD"</code>
</li>
<li>
<code>end_date</code>: character with the last date to consult in
the format <code>"YYYY-MM_DD"</code>. (Last available date is
<code>"2023-05-31"</code>
</li>
<li>
<code>frequency</code>: character with the aggregation frequency.
(<code>"day"</code>, <code>"week"</code>, <code>"month"</code> or
<code>"year"</code>)</li>
<li>
<code>tags</code>: character containing climate tags to consult</li>
<li>
<code>aggregate</code>: logical for data aggregation, if
<code>FALSE</code>, returns the data from each individual station in the
area. (Default = <code>TRUE</code>)</li>
</ul>
<p>We will use the same ROI created for the previous example.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_temperature_roi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_climate_geom.html">download_climate_geom</a></span><span class="op">(</span></span>
<span>  geometry <span class="op">=</span> <span class="va">roi</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2016-12-31"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  tags <span class="op">=</span> <span class="st">"TSSM_CON"</span>,</span>
<span>  aggregate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">db_temperature_roi</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">TSSM_CON</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dry-bulb Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dry-bulb temperature [C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/plot%20temperatures%20roi-1.png" width="700"></p>
<p>As we can see, the results are exactly the same as before.</p>
</div>
<div class="section level2">
<h2 id="retrieving-climate-data-for-municipality">Retrieving climate data for municipality<a class="anchor" aria-label="anchor" href="#retrieving-climate-data-for-municipality"></a>
</h2>
<p>To make the download process even easier, and avoid the creation of
already known geometries like municipalities or departments,
<strong>ColOpenData</strong> offers an extra function to download data
using the areas’ DIVIPOLA code.</p>
<p>DIVIPOLA codification is standardized for the whole country, and
contains department’s and municipalities’ codes. Departments have two
digits for individual identification, while municipalities have three;
however, for the usage of this function at the level of municipalities,
we need to concatenate both, obtaining a five digit number with
department and municipality codes. The codes for each municipality and
department can be consulted in the following <a href="https://www.datos.gov.co/widgets/gdxc-w37w" class="external-link">table</a>.</p>
<p>To replicate our previous example we only need the code for
Manizales, which is <code>"17001"</code>, which means the code for the
department Caldas (where Manizales is located) is <code>"17"</code> and
the code for Manizales inside that department is <code>"001"</code>.</p>
<p>The function <code>download_climate</code> will require almost the
same arguments than <code>download_climate_geom</code>, but replace the
<code>sf</code> object for a character containing the DIVIPOLA code:</p>
<ul>
<li>
<code>code</code>: character with the DIVIPOLA code for the
area</li>
<li>
<code>start_date</code>: character with the first date to consult in
the format <code>"YYYY-MM-DD"</code>
</li>
<li>
<code>end_date</code>: character with the last date to consult in
the format <code>"YYYY-MM_DD"</code>. (Last available date is
<code>"2023-05-31"</code>
</li>
<li>
<code>frequency</code>: character with the aggregation frequency.
(<code>"day"</code>, <code>"week"</code>, <code>"month"</code> or
<code>"year"</code>)</li>
<li>
<code>tags</code>: character containing climate tags to consult</li>
<li>
<code>aggregate</code>: logical for data aggregation, if
<code>FALSE</code>, returns the data from each individual station in the
area. (Default = <code>TRUE</code>)</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db_temperature_mpio</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_climate.html">download_climate</a></span><span class="op">(</span></span>
<span>  code <span class="op">=</span> <span class="st">"17001"</span>,</span>
<span>  start_date <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="st">"2016-12-31"</span>,</span>
<span>  frequency <span class="op">=</span> <span class="st">"day"</span>,</span>
<span>  tags <span class="op">=</span> <span class="st">"TSSM_CON"</span>,</span>
<span>  aggregate <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">db_temperature_mpio</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">TSSM_CON</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#106ba0"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Dry-bulb Temperature"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Date"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Dry-bulb temperature [C]"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 61 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="climate_data_files/figure-html/plot%20temperatures%20mpios-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Maria Camila Tavera Cifuentes, Julian Otero, Juan D. Umana, Juan F. Montenegro.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
