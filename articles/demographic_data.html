<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ColOpenData">
<title>A Deep Dive into Colombian Demographics Using ColOpenData • ColOpenData</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Deep Dive into Colombian Demographics Using ColOpenData">
<meta property="og:description" content="ColOpenData">
<meta property="og:image" content="https://epiverse-trace.github.io/ColOpenData/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">ColOpenData</a>

    <small class="nav-text text-muted me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Documentation and Dictionaries</h6>
    <a class="dropdown-item" href="../articles/documentation_and_dictionaries.html">Documentation and Dictionaries</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Download data</h6>
    <a class="dropdown-item" href="../articles/demographic_data.html">A Deep Dive into Colombian Demographics Using ColOpenData</a>
    <a class="dropdown-item" href="../articles/geospatial_data.html">Maps and plots with ColOpenData</a>
    <a class="dropdown-item" href="../articles/climate_data.html">How to download climate data using ColOpenData</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/ColOpenData/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>A Deep Dive into Colombian Demographics Using ColOpenData</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/ColOpenData/blob/HEAD/vignettes/demographic_data.Rmd" class="external-link"><code>vignettes/demographic_data.Rmd</code></a></small>
      <div class="d-none name"><code>demographic_data.Rmd</code></div>
    </div>

    
    
<div style="text-align: justify;">
<p><strong>ColOpenData</strong> can be used to access open demographic
data from Colombia. This demographic data is retrieved from the National
Administrative Department of Statistics (<a href="https://www.dane.gov.co/index.php/estadisticas-por-tema" class="external-link">DANE</a>).
The demographic module allows you to consult demographic data from the
National Population and Dwelling Census (CNPV) of 2018 and Population
Projections.</p>
<p>The available CNPV information is divided in four categories:
households, persons demographic, persons social and dwellings. The
population projections information presents data from 1950 to 2070 for a
national level, from 1985 to 2050 for a departmental level and from 1985
to 2035 for a municipal level. All data documentation can be accessed as
explained at <a href="https://epiverse-trace.github.io/ColOpenData/articles/documentation_and_dictionaries.html">Documentation
and Dictionaries</a>.</p>
<p>In order to access its documentation we need to use the function
<code>list_datasets</code> and indicate as a parameter the module we are
interested in. It is important to take a good look at this to have a
clearer understanding of what we count with, before just throwing
ourselves to work with the data. Now, we should start by loading all
necessary libraries. As the goal of this vignette is to show some
examples on how to use the data, we will load some specific libraries
but that does not mean they are required to use the data in all
cases.</p>
<p><strong>As an important clarification, all data is loaded and not
downloaded, which means it will be stored as part of the environment,
but will not be downloaded to user’s computer.</strong></p>
</div>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/epiverse-trace/ColOpenData" class="external-link">ColOpenData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="initial-exploration-basic-data-handling-with-colopendata">Initial Exploration: Basic Data Handling with ColOpenData<a class="anchor" aria-label="anchor" href="#initial-exploration-basic-data-handling-with-colopendata"></a>
</h2>
<div class="section level3">
<h3 id="documentation-access">Documentation access<a class="anchor" aria-label="anchor" href="#documentation-access"></a>
</h3>
<div style="text-align: justify;">
<p>First, we have to access the demographic documentation, to check
available datasets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datasets_dem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/list_datasets.html">list_datasets</a></span><span class="op">(</span><span class="st">"demographic"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">datasets_dem</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   name       group source year        level   category</span></span>
<span><span class="co">#&gt; 11 DANE_CNPVH_2018_1HD demographic   DANE 2018   department households</span></span>
<span><span class="co">#&gt; 12 DANE_CNPVH_2018_1HM demographic   DANE 2018 municipality households</span></span>
<span><span class="co">#&gt; 13 DANE_CNPVH_2018_2HD demographic   DANE 2018   department households</span></span>
<span><span class="co">#&gt; 14 DANE_CNPVH_2018_2HM demographic   DANE 2018 municipality households</span></span>
<span><span class="co">#&gt; 15 DANE_CNPVH_2018_3HD demographic   DANE 2018   department households</span></span>
<span><span class="co">#&gt; 16 DANE_CNPVH_2018_3HM demographic   DANE 2018 municipality households</span></span>
<span><span class="co">#&gt;                                                                                                                      description</span></span>
<span><span class="co">#&gt; 11   Number of households with persons under 15 years of age and number of persons under 15 years of age, by department and area</span></span>
<span><span class="co">#&gt; 12 Number of households with persons under 15 years of age and number of persons under 15 years of age, by municipality and area</span></span>
<span><span class="co">#&gt; 13                      Number of households with senior citizens and number of persons aged 60 and over, by department and area</span></span>
<span><span class="co">#&gt; 14                    Number of households with senior citizens and number of persons aged 60 and over, by municipality and area</span></span>
<span><span class="co">#&gt; 15                                                                                Households by headship, by department and area</span></span>
<span><span class="co">#&gt; 16                                                                              Households by headship, by municipality and area</span></span></code></pre></div>
<p>After checking the documentation, we can load the data we want to
work with. To do this, we will use the <code>download_demographic</code>
function that takes by parameter the data name, presented in the
documentation. For this first example we will focus on a CNPV
dataset.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-load">Data load<a class="anchor" aria-label="anchor" href="#data-load"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a demographic dataset</span></span>
<span><span class="va">public_services_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_demographic.html">download_demographic</a></span><span class="op">(</span><span class="st">"DANE_CNPVV_2018_8VD"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original data is provided by the National Administrative Department of</span></span>
<span><span class="co">#&gt; Statistics (DANE).</span></span>
<span><span class="co">#&gt; Reformatted by the package authors.</span></span>
<span><span class="co">#&gt; Stored and redistributed by Universidad de Los Andes under the Epiverse</span></span>
<span><span class="co">#&gt; TRACE iniative.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">public_services_d</span><span class="op">)</span></span>
<span><span class="co">#&gt;   codigo_departamento   departamento     area  servicio_publico      disponible</span></span>
<span><span class="co">#&gt; 1                  00 Total nacional    total energia_electrica              si</span></span>
<span><span class="co">#&gt; 2                  00 Total nacional    total energia_electrica              no</span></span>
<span><span class="co">#&gt; 3                  00 Total nacional    total energia_electrica sin_informacion</span></span>
<span><span class="co">#&gt; 4                  00 Total nacional cabecera energia_electrica              si</span></span>
<span><span class="co">#&gt; 5                  00 Total nacional cabecera energia_electrica              no</span></span>
<span><span class="co">#&gt; 6                  00 Total nacional cabecera energia_electrica sin_informacion</span></span>
<span><span class="co">#&gt;      total</span></span>
<span><span class="co">#&gt; 1 12984126</span></span>
<span><span class="co">#&gt; 2   496603</span></span>
<span><span class="co">#&gt; 3        0</span></span>
<span><span class="co">#&gt; 4 10485896</span></span>
<span><span class="co">#&gt; 5    81579</span></span>
<span><span class="co">#&gt; 6        0</span></span></code></pre></div>
<div style="text-align: justify;">
<p>As it can be seen above, <u>public_services_d</u> presents
information regarding availability of public services in the country in
2018, at the department level. Now, with this data we could, for
example, find the proportion of dwellings that have access to a water
supply system (WSS) by department and plot it.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-filter-and-plot">Data filter and plot<a class="anchor" aria-label="anchor" href="#data-filter-and-plot"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset data so it presents the information regarding the WSS, by department</span></span>
<span><span class="va">wss</span> <span class="op">&lt;-</span> <span class="va">public_services_d</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"total_departamental"</span> <span class="op">&amp;</span> <span class="va">servicio_publico</span> <span class="op">==</span> <span class="st">"acueducto"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">departamento</span>, <span class="va">disponible</span>, <span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the total counts for each department (for all situations)</span></span>
<span><span class="va">total_counts</span> <span class="op">&lt;-</span> <span class="va">wss</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">departamento</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the proportion of counts of "si" by department</span></span>
<span><span class="va">proportions_wss</span> <span class="op">&lt;-</span> <span class="va">wss</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">disponible</span> <span class="op">==</span> <span class="st">"si"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">total_counts</span>, by <span class="op">=</span> <span class="st">"departamento"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>proportion_si <span class="op">=</span> <span class="va">total</span> <span class="op">/</span> <span class="va">total_all</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change the value of cell San Andres</span></span>
<span><span class="va">proportions_wss</span><span class="op">[</span><span class="fl">28</span>, <span class="st">"departamento"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"SAPSC"</span></span>
<span></span>
<span><span class="co"># Plot proportions_wss of dwellings with access to WSS by deparment</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">proportions_wss</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">departamento</span>, <span class="op">-</span><span class="va">proportion_si</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="va">proportion_si</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"#10bed2"</span>, color <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Proportion of dwellings with access to WSS, by department"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Department"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Proportion"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="demographic_data_files/figure-html/data%20filter%20and%20plot-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="data-integration-combining-datasets-for-enhanced-analysis">Data Integration: Combining Datasets for Enhanced Analysis<a class="anchor" aria-label="anchor" href="#data-integration-combining-datasets-for-enhanced-analysis"></a>
</h2>
<div style="text-align: justify;">
<p>Also, with the CNPV data, we could merge data from the different
categories and compare information. For example, we would download a
dataset from the persons demographic category and another one from
persons social. The first one presents information regarding
population’s literacy and the second one regarding its marital
status.</p>
</div>
<div class="section level3">
<h3 id="data-load-1">Data load<a class="anchor" aria-label="anchor" href="#data-load-1"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Loading data, this can take a while"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading data, this can take a while</span></span>
<span><span class="va">literacy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_demographic.html">download_demographic</a></span><span class="op">(</span><span class="st">"DANE_CNPVPD_2018_16PM"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original data is provided by the National Administrative Department of</span></span>
<span><span class="co">#&gt; Statistics (DANE).</span></span>
<span><span class="co">#&gt; Reformatted by the package authors.</span></span>
<span><span class="co">#&gt; Stored and redistributed by Universidad de Los Andes under the Epiverse</span></span>
<span><span class="co">#&gt; TRACE iniative.</span></span>
<span><span class="va">marital_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_demographic.html">download_demographic</a></span><span class="op">(</span><span class="st">"DANE_CNPVPS_2018_7PM"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original data is provided by the National Administrative Department of</span></span>
<span><span class="co">#&gt; Statistics (DANE).</span></span>
<span><span class="co">#&gt; Reformatted by the package authors.</span></span>
<span><span class="co">#&gt; Stored and redistributed by Universidad de Los Andes under the Epiverse</span></span>
<span><span class="co">#&gt; TRACE iniative.</span></span></code></pre></div>
<div style="text-align: justify;">
<p>For this example, we will focus on a specific municipality, examining
the total area and specifically concentrating on the age group between
15 and 24 years old. Since we want to compare both datasets
simultaneously, it’s important to first ensure they have the same
population count under identical conditions. Most columns in the
demographic datasets contain a <u>total</u> value, which aggregates data
across all conditions. For instance, the ‘sex’ column includes ‘male’,
‘female’, and <u>total</u>, representing both genders combined.
Similarly, the ‘marital status’ column’s <u>total</u> value encompasses
the entire population, irrespective of their marital status.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-check">Data check<a class="anchor" aria-label="anchor" href="#data-check"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Literacy data filter to have a population's count under specific conditions</span></span>
<span><span class="va">lit</span> <span class="op">&lt;-</span> <span class="va">literacy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">municipio</span> <span class="op">==</span> <span class="st">"Villapinzón"</span> <span class="op">&amp;</span> <span class="va">grupo_de_edad</span> <span class="op">==</span> <span class="st">"entre_15_y_24_anos"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span> <span class="va">sabe_leer_y_escribir</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span> <span class="va">sexo</span> <span class="op">==</span> <span class="st">"total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">municipio</span>, <span class="va">area</span>, <span class="va">grupo_de_edad</span>, <span class="va">sexo</span>, <span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Marital status data filter to find population's count under certain conditions</span></span>
<span><span class="va">ms_15_19</span> <span class="op">&lt;-</span> <span class="va">marital_status</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">municipio</span> <span class="op">==</span> <span class="st">"Villapinzón"</span> <span class="op">&amp;</span> <span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">grupo_de_edad</span> <span class="op">==</span> <span class="st">"15_a_19"</span> <span class="op">&amp;</span> <span class="va">estado_civil</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">sexo</span> <span class="op">==</span> <span class="st">"total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">grupo_de_edad</span>, <span class="va">estado_civil</span>, <span class="va">sexo</span>, <span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ms_20_24</span> <span class="op">&lt;-</span> <span class="va">marital_status</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">municipio</span> <span class="op">==</span> <span class="st">"Villapinzón"</span> <span class="op">&amp;</span> <span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">grupo_de_edad</span> <span class="op">==</span> <span class="st">"20_a_24"</span> <span class="op">&amp;</span> <span class="va">estado_civil</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">sexo</span> <span class="op">==</span> <span class="st">"total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">grupo_de_edad</span>, <span class="va">estado_civil</span>, <span class="va">sexo</span>, <span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ms_15_19</span>, <span class="va">ms_20_24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sum of counts of both age groups</span></span>
<span><span class="va">ms_count</span> <span class="op">&lt;-</span> <span class="va">ms</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">estado_civil</span>, <span class="va">sexo</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">count_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString</a></span><span class="op">(</span><span class="va">ms_count</span><span class="op">$</span><span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># New row with summed information</span></span>
<span><span class="va">new_row</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  grupo_de_edad <span class="op">=</span> <span class="st">"15_a_24"</span>, estado_civil <span class="op">=</span> <span class="st">"total"</span>,</span>
<span>  sexo <span class="op">=</span> <span class="st">"total"</span>, total <span class="op">=</span> <span class="va">count_total</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Final dataframe with counts for each group independently and together, with</span></span>
<span><span class="co"># rows names modification</span></span>
<span></span>
<span><span class="va">ms_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ms</span>, <span class="va">new_row</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms_f</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ms_f</span><span class="op">)</span></span></code></pre></div>
<div style="text-align: justify;">
<p>Now that we know that both data sets contain the same counts, we can
start to look at the specific information we want. For the literacy data
set, we would focus on the people that do not know how to read neither
write.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-filter-and-plot-1">Data filter and plot<a class="anchor" aria-label="anchor" href="#data-filter-and-plot-1"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter of literacy data to get only the counts for specific conditions</span></span>
<span><span class="va">lit_filt</span> <span class="op">&lt;-</span> <span class="va">literacy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">municipio</span> <span class="op">==</span> <span class="st">"Villapinzón"</span> <span class="op">&amp;</span> <span class="va">sabe_leer_y_escribir</span> <span class="op">==</span> <span class="st">"no"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">grupo_de_edad</span> <span class="op">==</span> <span class="st">"entre_15_y_24_anos"</span> <span class="op">&amp;</span> <span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">sabe_leer_y_escribir</span>, <span class="va">grupo_de_edad</span>, <span class="va">sexo</span>, <span class="va">total</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>estado <span class="op">=</span> <span class="st">"no_sabe_leer_y_escribir"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">sabe_leer_y_escribir</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>proportion <span class="op">=</span> <span class="va">total</span> <span class="op">/</span> <span class="va">lit</span><span class="op">$</span><span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter of marital status data to get only the counts for specific conditions</span></span>
<span><span class="va">ms_filt15</span> <span class="op">&lt;-</span> <span class="va">marital_status</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">municipio</span> <span class="op">==</span> <span class="st">"Villapinzón"</span> <span class="op">&amp;</span> <span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">grupo_de_edad</span> <span class="op">==</span> <span class="st">"15_a_19"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">grupo_de_edad</span>, <span class="va">estado_civil</span>, <span class="va">sexo</span>, <span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter of marital status data to get only the counts for specific conditions</span></span>
<span><span class="va">ms_filt20</span> <span class="op">&lt;-</span> <span class="va">marital_status</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">municipio</span> <span class="op">==</span> <span class="st">"Villapinzón"</span> <span class="op">&amp;</span> <span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">grupo_de_edad</span> <span class="op">==</span> <span class="st">"20_a_24"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">grupo_de_edad</span>, <span class="va">estado_civil</span>, <span class="va">sexo</span>, <span class="va">total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge of both marital status dataframes</span></span>
<span><span class="va">ms_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ms_filt15</span>, <span class="va">ms_filt20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Data frame with marital status info and proportions based on columns</span></span>
<span><span class="va">ms_final</span> <span class="op">&lt;-</span> <span class="va">ms_filt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">estado_civil</span>, <span class="va">sexo</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>grupo_de_edad <span class="op">=</span> <span class="st">"entre_15_y_24_anos"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>estado <span class="op">=</span> <span class="va">estado_civil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>proportion <span class="op">=</span> <span class="va">total</span> <span class="op">/</span> <span class="va">lit</span><span class="op">$</span><span class="va">total</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'estado_civil'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span></span>
<span><span class="co"># Merged marital status and literacy final df, with subsets to a better graph</span></span>
<span><span class="va">merged_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">lit_filt</span>, <span class="va">ms_final</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">sexo</span> <span class="op">!=</span> <span class="st">"total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">estado</span> <span class="op">!=</span> <span class="st">"total"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">estado</span> <span class="op">!=</span> <span class="st">"soltero_a"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">merged_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">estado</span>, y <span class="op">=</span> <span class="va">proportion</span>, fill <span class="op">=</span> <span class="va">sexo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mujer <span class="op">=</span> <span class="st">"#f04a4c"</span>, hombre <span class="op">=</span> <span class="st">"#aec800"</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Proportion of people in Villapinzón by marital status and</span></span>
<span><span class="st">    iliteracy by sex"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Status"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Count"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Sex"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="demographic_data_files/figure-html/other%20data%20plot-1.png" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="forecasting-the-future-analyzing-population-projections">Forecasting the Future: Analyzing Population Projections<a class="anchor" aria-label="anchor" href="#forecasting-the-future-analyzing-population-projections"></a>
</h2>
<div style="text-align: justify;">
<p>Now, as a third example, we will take a look at a population
projections dataset presenting projections and back projections of
national population by area, sex and age for the period from 1950 to
2070.</p>
<p>First, we will observe the variation on the female and male
population within the years, covering the period from 2024 to 2034.</p>
</div>
<div class="section level3">
<h3 id="data-load-filter-and-plot">Data load, filter and plot<a class="anchor" aria-label="anchor" href="#data-load-filter-and-plot"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Download data</span></span>
<span><span class="va">asen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_demographic.html">download_demographic</a></span><span class="op">(</span><span class="st">"DANE_PP_1950_2070_ASEN"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Original data is provided by the National Administrative Department of</span></span>
<span><span class="co">#&gt; Statistics (DANE).</span></span>
<span><span class="co">#&gt; Reformatted by the package authors.</span></span>
<span><span class="co">#&gt; Stored and redistributed by Universidad de Los Andes under the Epiverse</span></span>
<span><span class="co">#&gt; TRACE iniative.</span></span>
<span></span>
<span><span class="co"># Subset data</span></span>
<span><span class="va">male</span> <span class="op">&lt;-</span> <span class="va">asen</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span> <span class="va">sexo</span> <span class="op">==</span> <span class="st">"total_hombres"</span> <span class="op">&amp;</span> <span class="va">ano</span> <span class="op">&gt;</span> <span class="fl">2023</span> <span class="op">&amp;</span> <span class="va">ano</span> <span class="op">&lt;</span> <span class="fl">2035</span><span class="op">)</span></span>
<span></span>
<span><span class="va">female</span> <span class="op">&lt;-</span> <span class="va">asen</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span> <span class="va">sexo</span> <span class="op">==</span> <span class="st">"total_mujeres"</span> <span class="op">&amp;</span> <span class="va">ano</span> <span class="op">&gt;</span> <span class="fl">2023</span> <span class="op">&amp;</span> <span class="va">ano</span> <span class="op">&lt;</span> <span class="fl">2035</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mandf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">male</span>, <span class="va">female</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot of population in a national level by year and sex</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">mandf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ano</span>, y <span class="op">=</span> <span class="va">total</span>, fill <span class="op">=</span> <span class="va">sexo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>total_mujeres <span class="op">=</span> <span class="st">"#f04a4c"</span>, total_hombres <span class="op">=</span> <span class="st">"#aec800"</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Population in Colombia from 2024 to 2034 by sex"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Population"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Sex"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">mandf</span><span class="op">$</span><span class="va">ano</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="demographic_data_files/figure-html/pop%20projections%20first%20example-1.png" width="700"></p>
<div style="text-align: justify;">
<p>In the graph presented above, we observe that the male population
slightly exceeds the female population for the selected period. As a
second step in our analysis of the dataset, we will focus on the male
population by age in the year with the highest male population value
from 2024 to 2034, which is the year 2034.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-load-filter-and-plot-1">Data load, filter and plot<a class="anchor" aria-label="anchor" href="#data-load-filter-and-plot-1"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset data</span></span>
<span><span class="va">male_2034_99</span> <span class="op">&lt;-</span> <span class="va">asen</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span> <span class="va">ano</span> <span class="op">==</span> <span class="fl">2034</span> <span class="op">&amp;</span> <span class="va">sexo</span> <span class="op">==</span> <span class="st">"hombre"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">edad</span> <span class="op">!=</span> <span class="st">"100_y_mas"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>edad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">edad</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">male_2034_100</span> <span class="op">&lt;-</span> <span class="va">asen</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">area</span> <span class="op">==</span> <span class="st">"total"</span> <span class="op">&amp;</span> <span class="va">ano</span> <span class="op">==</span> <span class="fl">2034</span> <span class="op">&amp;</span> <span class="va">sexo</span> <span class="op">==</span> <span class="st">"hombre"</span> <span class="op">&amp;</span></span>
<span>    <span class="va">edad</span> <span class="op">==</span> <span class="st">"100_y_mas"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>age_group <span class="op">=</span> <span class="va">edad</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>total_sum <span class="op">=</span> <span class="va">total</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">age_group</span>, <span class="va">total_sum</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define age groups</span></span>
<span><span class="va">age_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">male_2034_99</span><span class="op">$</span><span class="va">edad</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">12</span>, <span class="fl">19</span>, <span class="fl">29</span>, <span class="fl">39</span>, <span class="fl">49</span>, <span class="fl">59</span>, <span class="fl">69</span>, <span class="fl">79</span>, <span class="fl">89</span>, <span class="fl">99</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"0-2"</span>, <span class="st">"3-12"</span>, <span class="st">"13-19"</span>, <span class="st">"20-29"</span>, <span class="st">"30-39"</span>, <span class="st">"40-49"</span>,</span>
<span>    <span class="st">"50-59"</span>, <span class="st">"60-69"</span>, <span class="st">"70-79"</span>, <span class="st">"80-89"</span>, <span class="st">"90-99"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add age groups to the data frame</span></span>
<span><span class="va">male_agegroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">male_2034_99</span>, age_group <span class="op">=</span> <span class="va">age_groups</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate new totals for age groups</span></span>
<span><span class="va">summarized_data</span> <span class="op">&lt;-</span> <span class="va">male_agegroups</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>total_sum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Bind dataframes</span></span>
<span><span class="va">merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">summarized_data</span>, <span class="va">male_2034_100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fix the order of ages appearance in the plot</span></span>
<span><span class="va">merged</span><span class="op">$</span><span class="va">age_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">merged</span><span class="op">$</span><span class="va">age_group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">merged</span><span class="op">$</span><span class="va">age_group</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot of male population in a national level by age group in 2052</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">merged</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">age_group</span>,</span>
<span>  y <span class="op">=</span> <span class="va">total_sum</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"#f04a4c"</span>, color <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Male population counts in Colombia by age group in 2034"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age group"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Male population"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="demographic_data_files/figure-html/pop%20projections%20second%20example-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by M. Camila Tavera-Cifuentes, Julian Otero, Juan D. Umana, Juan Montenegro-Torres.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
